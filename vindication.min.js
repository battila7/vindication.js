function collectContraint(n,e){for(var t=e.split("."),r=n,i=0;i<t.length&&r[t[i]];++i)r=r[t[i]];return r}var _=require("isa.js"),Vindication={requiredFn:function(n,e){return!e||n},minlengthFn:function(n,e){return n&&n.length>=e},maxlengthFn:function(n,e){return!n||n.length<=e},lengthFn:function(n,e){return _.isString(e)&&(e=JSON.parse(e)),this.minlengthFn(n,e[0])&&this.maxlengthFn(n,e[1])},elementFn:function(n,e){return Array.isArray(e)&&e.indexOf(n)!==-1},minFn:function(n,e){return n&&Number(n)>=e},maxFn:function(n,e){return n&&Number(n)<=e},rangeFn:function(n,e){return n&&n>=e[0]&&n<=e[1]},patternFn:function(n,e){return new RegExp(e).test(n)},equaltoFn:function(n,e){return n===e},notblank:function(n,e){return!e||this.minlengthFn(n,1)},beforeFn:function(n,e){return this.maxFn(n.getTime?n.getTime():n,e.getTime?e.getTime():e)},afterFn:function(n,e){return this.minFn(n.getTime?n.getTime():n,e.getTime?e.getTime():e)},typeFn:function(n,e){var t;switch(e){case"number":t=/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/;break;case"digits":t=/^\d+$/;break;case"integer":t=/^-?\d+$/;break;case"alphanum":t=/^\w+$/;break;case"email":t=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i;break;case"url":t=new RegExp("(https?:\\/\\/)?(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,4}\\b([-a-zA-Z0-9@:%_\\+.~#?&//=]*)","i");break;case"dateIso":t=/^(\d{4})\D?(0[1-9]|1[0-2])\D?([12]\d|0[1-9]|3[01])$/;break;case"phone":t=/^((\+\d{1,3}(-| )?\(?\d\)?(-| )?\d{1,5})|(\(?\d{2,6}\)?))(-| )?(\d{3,4})(-| )?(\d{4})(( x| ext)\d{1,5}){0,1}$/;break;default:return!1}return!!n&&t.test(n)},checkConstraints:function(n,e,t,r,i){var a=this;if(_.isFunction(t)){if(!t.call(r,e))return"This value seems to be invalid: "+e}else{if(_.isArray(t)){var u=[];return t.forEach(function(t){var s=a.checkConstraints(n,e,t,r,i);s&&u.push(s)}),0===u.length?null:u[0]}if(i.ignores)for(var s=0;s<i.ignores.length;++s)if(t[i.ignores[s]])return null;if(t.condition&&!t.condition.call(r,e))return null;if(("undefined"==typeof e||""===e||null===e)&&!t.required)return null;for(var l in t)if("message"!==l&&"condition"!==l){var o=t[l];if(!o.condition||o.condition.call(r,e)){var c=a[l+"Fn"](e,o.params||o)?null:(t.message||"This value seems to be invalid:")+" "+e;if(c)return c}}}return null},walk:function(n,e,t,r,i){var a,u=this;if(_.isString(e))return u.checkConstraints(n,e,t,r,i);if(_.isBoolean(e))return u.checkConstraints(n,e,t,r,i);if(_.isNumber(e))return u.checkConstraints(n,e,t,r,i);if(_.isDate(e))return u.checkConstraints(n,e,t,r,i);if(_.isRegExp(e))return null;if(Array.isArray(e))return a=[],e.forEach(function(e){var s=u.walk(n,e,t,r,i);s&&a.push(s)}),0===a.length?null:a;if(_.isFunction(e))return u.checkConstraints(n,e.call(r),t,r,i);if(_.isObject(e)){if(_.isFunction(t))return u.checkConstraints(n,e,t,r,i);a={};for(var s in e)if(s&&t[s]){var l=e[s],o=u.walk(n,l,t[s],r,i);o&&(a[s]=o)}return 0===Object.keys(a).length?null:a}return null}};module.exports={version:"3.0.2",validateValue:function(n,e,t,r,i){var a=collectContraint(t,e);return Vindication.walk(n,n,a||{},r||n,i||{})},validate:function(n,e,t,r){return Vindication.walk(n,n,e||{},t||n,r||{})},validateAll:function(n,e,t,r){if(!Array.isArray(n))return this.validate(n,e,t);var i=[];return n.forEach(function(n){i.push(Vindication.walk(n,n,e||{},t||n,r||{}))}),i}};