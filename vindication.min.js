function collectContraint(n,t){for(var r=n,e=0;e<t.length&&r;++e)r=r[t[e]];return r}var _=require("isa.js"),Vindication={requiredFn:function(n,t){return!t||n},minlengthFn:function(n,t){return n&&n.length>=t},maxlengthFn:function(n,t){return!n||n.length<=t},lengthFn:function(n,t){return _.isString(t)&&(t=JSON.parse(t)),this.minlengthFn(n,t[0])&&this.maxlengthFn(n,t[1])},elementFn:function(n,t){return Array.isArray(t)&&-1!==t.indexOf(n)},minFn:function(n,t){return n&&Number(n)>=t},maxFn:function(n,t){return n&&Number(n)<=t},rangeFn:function(n,t){return n&&n>=t[0]&&n<=t[1]},patternFn:function(n,t){return new RegExp(t).test(n)},equaltoFn:function(n,t){return n===t},notblank:function(n,t){return!t||this.minlengthFn(n,1)},beforeFn:function(n,t){return this.maxFn(n.getTime?n.getTime():n,t.getTime?t.getTime():t)},afterFn:function(n,t){return this.minFn(n.getTime?n.getTime():n,t.getTime?t.getTime():t)},typeFn:function(n,t){var r;switch(t){case"number":r=/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/;break;case"digits":r=/^\d+$/;break;case"integer":r=/^-?\d+$/;break;case"alphanum":r=/^\w+$/;break;case"email":r=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i;break;case"url":r=new RegExp("(https?:\\/\\/)?(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,4}\\b([-a-zA-Z0-9@:%_\\+.~#?&//=]*)","i");break;case"dateIso":r=/^(\d{4})\D?(0[1-9]|1[0-2])\D?([12]\d|0[1-9]|3[01])$/;break;case"phone":r=/^((\+\d{1,3}(-| )?\(?\d\)?(-| )?\d{1,5})|(\(?\d{2,6}\)?))(-| )?(\d{3,4})(-| )?(\d{4})(( x| ext)\d{1,5}){0,1}$/;break;default:return!1}return!!n&&r.test(n)},_checkConstraints:function(n,t,r,e,i){var a=this;if(_.isFunction(r)){if(!r.call(e,t))return"This value seems to be invalid: "+t}else{if(_.isArray(r)){var u=[];return r.forEach(function(r){var s=a.checkConstraints(n,t,r,e,i);s&&u.push(s)}),0===u.length?null:u[0]}if(i.ignores)for(var s=0;s<i.ignores.length;++s)if(r[i.ignores[s]])return null;if(r.condition&&!r.condition.call(e,t))return null;if((void 0===t||""===t||null===t)&&!r.required)return null;for(var o in r)if("message"!==o&&"condition"!==o){var c=r[o];if(!c.condition||c.condition.call(e,t)){var l=a[o+"Fn"](t,c.params||c)?null:(r.message||"This value seems to be invalid:")+" "+t;if(l)return l}}}return null},checkConstraints:function(n,t,r,e,i){try{return this._checkConstraints(n,t,r,e,i)}catch(n){console.error(n,t,r)}},walk:function(n,t,r,e,i){var a,u=this;if(_.isString(t))return u.checkConstraints(n,t,r,e,i);if(_.isBoolean(t))return u.checkConstraints(n,t,r,e,i);if(_.isNumber(t))return u.checkConstraints(n,t,r,e,i);if(_.isDate(t))return u.checkConstraints(n,t,r,e,i);if(_.isRegExp(t))return null;if(Array.isArray(t)){if(a=[],r._validator){var s=u.checkConstraints(n,t,r._validator,e,i);s&&a.push(s)}return t.forEach(function(t){var s=u.walk(n,t,r,e,i);s&&a.push(s)}),0===a.length?null:a}if(_.isFunction(t))return u.checkConstraints(n,t.call(e),r,e,i);if(_.isObject(t)){if(_.isFunction(r))return u.checkConstraints(n,t,r,e,i);if(a={},r._validator)return u.checkConstraints(n,t,r._validator,e,i);for(var o in t)if(o&&r[o]){var c=t[o],l=u.walk(n,c,r[o],e,i);l&&(a[o]=l)}return 0===Object.keys(a).length?null:a}return null}};module.exports={version:"3.0.2",validateValue:function(n,t,r,e,i){var a=collectContraint(r,t.split("."));return Vindication.walk(n,n,a||{},e||n,i||{})},validate:function(n,t,r,e){return Vindication.walk(n,n,t||{},r||n,e||{})},validateAll:function(n,t,r,e){if(!Array.isArray(n))return this.validate(n,t,r);var i=[];return n.forEach(function(n){i.push(Vindication.walk(n,n,t||{},r||n,e||{}))}),i}};