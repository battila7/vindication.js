var _=require("lodash"),Vindication={requiredFn:function(n,e){return!e||n},minlengthFn:function(n,e){return n&&n.length>=e},maxlengthFn:function(n,e){return!n||n.length<=e},lengthFn:function(n,e){return _.isString(e)&&(e=JSON.parse(e)),this.minlengthFn(n,e[0])&&this.maxlengthFn(n,e[1])},elementFn:function(n,e){return _.isArray(e)&&-1!==e.indexOf(n)},minFn:function(n,e){return n&&Number(n)>=e},maxFn:function(n,e){return n&&Number(n)<=e},rangeFn:function(n,e){return n&&n>=e[0]&&n<=e[1]},patternFn:function(n,e){return new RegExp(e).test(n)},equaltoFn:function(n,e){return n===e},mincheckFn:function(n,e){return this.minlengthFn(n,e)},maxcheckFn:function(n,e){return this.maxlengthFn(n,e)},checkFn:function(n,e){return this.lengthFn(n,e)},beforeFn:function(n,e){return this.maxFn(n.getTime?n.getTime():n,e.getTime?e.getTime():e)},afterFn:function(n,e){return this.minFn(n.getTime?n.getTime():n,e.getTime?e.getTime():e)},typeFn:function(n,e){var u;switch(e){case"number":u=/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/;break;case"digits":u=/^\d+$/;break;case"integer":u=/^-?\d+$/;break;case"alphanum":u=/^\w+$/;break;case"email":u=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i;break;case"url":u=new RegExp("(https?:\\/\\/)?(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,4}\\b([-a-zA-Z0-9@:%_\\+.~#?&//=]*)","i");break;case"dateIso":u=/^(\d{4})\D?(0[1-9]|1[0-2])\D?([12]\d|0[1-9]|3[01])$/;break;case"phone":u=/^((\+\d{1,3}(-| )?\(?\d\)?(-| )?\d{1,5})|(\(?\d{2,6}\)?))(-| )?(\d{3,4})(-| )?(\d{4})(( x| ext)\d{1,5}){0,1}$/;break;default:return!1}return""!==n?u.test(n):!1},checkConstraints:function(n,e,u,F){var t=this;if(_.isFunction(u)){if(!u.call(F,e))return"This value seems to be invalid: "+e}else for(var i in u)if("message"!==i){var r=u[i];if(r.params&&r.condition){if(r.condition(n)){var a=t[i+"Fn"](e,r.params)?null:(u.message||"This value seems to be invalid:")+" "+e;if(a)return a}}else{var s=t[i+"Fn"](e,r)?null:(u.message||"This value seems to be invalid:")+" "+e;if(s)return s}}},walk:function(n,e,u,F){var t,i=this;if(_.isString(e))return i.checkConstraints(n,e,u,F);if(_.isBoolean(e))return i.checkConstraints(n,e,u,F);if(_.isNumber(e))return i.checkConstraints(n,e,u,F);if(_.isDate(e))return i.checkConstraints(n,e,u,F);if(_.isRegExp(e))return null;if(_.isArray(e))return t=[],e.forEach(function(e){var r=i.walk(n,e,u,F);r&&t.push(r)}),t;if(_.isFunction(e))return i.checkConstraints(n,e.call(F),u,F);if(_.isObject(e)){if(_.isFunction(u))return i.checkConstraints(n,e,u,F);t={};for(var r in e)if(r&&e[r]&&u[r]){var a=i.walk(n,e[r],u[r],F);a&&(t[r]=a)}return t}}};module.exports={version:"3.0.0",validate:function(n,e,u){return Vindication.walk(n,n,e,u)},validateAll:function(n,e,u){if(!_.isArray(n))return this.validate(n,e,u);var F=[];return n.forEach(function(n){F.push(Vindication.walk(n,n,e,u))}),F}};