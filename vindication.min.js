function collectContraint(n,t){for(var e=n,r=0;r<t.length&&e;++r)e=e[t[r]];return e}var _=require("isa.js"),Vindication={requiredFn:function(n,t){return!t||n},minlengthFn:function(n,t){return n&&n.length>=t},maxlengthFn:function(n,t){return!n||n.length<=t},lengthFn:function(n,t){return _.isString(t)&&(t=JSON.parse(t)),this.minlengthFn(n,t[0])&&this.maxlengthFn(n,t[1])},elementFn:function(n,t){return Array.isArray(t)&&-1!==t.indexOf(n)},minFn:function(n,t){return n&&Number(n)>=t},maxFn:function(n,t){return n&&Number(n)<=t},rangeFn:function(n,t){return n&&n>=t[0]&&n<=t[1]},patternFn:function(n,t){return new RegExp(t).test(n)},equaltoFn:function(n,t){return n===t},notblank:function(n,t){return!t||this.minlengthFn(n,1)},beforeFn:function(n,t){return this.maxFn(n.getTime?n.getTime():n,t.getTime?t.getTime():t)},afterFn:function(n,t){return this.minFn(n.getTime?n.getTime():n,t.getTime?t.getTime():t)},typeFn:function(n,t){var e;switch(t){case"number":e=/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/;break;case"digits":e=/^\d+$/;break;case"integer":e=/^-?\d+$/;break;case"alphanum":e=/^\w+$/;break;case"email":e=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i;break;case"url":e=new RegExp("(https?:\\/\\/)?(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,4}\\b([-a-zA-Z0-9@:%_\\+.~#?&//=]*)","i");break;case"dateIso":e=/^(\d{4})\D?(0[1-9]|1[0-2])\D?([12]\d|0[1-9]|3[01])$/;break;case"phone":e=/^((\+\d{1,3}(-| )?\(?\d\)?(-| )?\d{1,5})|(\(?\d{2,6}\)?))(-| )?(\d{3,4})(-| )?(\d{4})(( x| ext)\d{1,5}){0,1}$/;break;default:return!1}return!!n&&e.test(n)},_checkConstraints:function(n,t,e,r,i){var a=this;if(_.isFunction(e)){if(!e.call(r,t))return"This value seems to be invalid: "+t}else{if(_.isArray(e)){var u=[];return e.forEach(function(e){var s=a.checkConstraints(n,t,e,r,i);s&&u.push(s)}),0===u.length?null:u[0]}if(i.ignores)for(var s=0;s<i.ignores.length;++s)if(e[i.ignores[s]])return null;if(e.condition&&!e.condition.call(r,t))return null;if((void 0===t||""===t||null===t)&&!e.required)return null;for(var c in e)if("message"!==c&&"condition"!==c){var o=e[c];if(!o.condition||o.condition.call(r,t)){var l=a[c+"Fn"](t,o.params||o)?null:(e.message||"This value seems to be invalid:")+" "+t;if(l)return l}}}return null},checkConstraints:function(n,t,e,r,i){try{return this._checkConstraints(n,t,e,r,i)}catch(n){console.error(n,t,e)}},walk:function(n,t,e,r,i){var a,u=this;if(_.isString(t))return u.checkConstraints(n,t,e,r,i);if(_.isBoolean(t))return u.checkConstraints(n,t,e,r,i);if(_.isNumber(t))return u.checkConstraints(n,t,e,r,i);if(_.isDate(t))return u.checkConstraints(n,t,e,r,i);if(_.isRegExp(t))return null;if(Array.isArray(t))return a=[],t.forEach(function(t){var s=u.walk(n,t,e,r,i);s&&a.push(s)}),0===a.length?null:a;if(_.isFunction(t))return u.checkConstraints(n,t.call(r),e,r,i);if(_.isObject(t)){if(_.isFunction(e))return u.checkConstraints(n,t,e,r,i);a={};for(var s in t)if(s&&e[s]){var c=t[s],o=u.walk(n,c,e[s],r,i);o&&(a[s]=o)}return 0===Object.keys(a).length?null:a}return null}};module.exports={version:"3.0.2",validateValue:function(n,t,e,r,i){var a=collectContraint(e,t.split("."));return Vindication.walk(n,n,a||{},r||n,i||{})},validate:function(n,t,e,r){return Vindication.walk(n,n,t||{},e||n,r||{})},validateAll:function(n,t,e,r){if(!Array.isArray(n))return this.validate(n,t,e);var i=[];return n.forEach(function(n){i.push(Vindication.walk(n,n,t||{},e||n,r||{}))}),i}};